version: 2
jobs:
   build:
     working_directory: ~/test
     docker:
       # This Image Has Composer Magically #
       - image: notnoopci/php:7.1.5-browsers

       ## DEFAULTS FOR THIS IMAGE ##
       - image: mysql
         environment:
           MYSQL_ROOT_PASSWORD: admin
           MYSQL_DATABASE: icp
           MYSQL_USER: drupal
           MYSQL_PASSWORD: drupal
         command: mysql --host=127.0.0.1 --user=root --password=admin 'create database drupal'

     steps:
       - checkout
       - run: composer install
       - run: composer global require drush/drush:dev-master
       - run: cd web/ && ../vendor/bin/drush site-install --db-url=mysql://root:@localhost/drupal
