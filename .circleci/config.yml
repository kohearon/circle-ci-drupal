version: 2
jobs:
   build:
     working_directory: ~/test
     docker:
       # This Image Has Composer Magically #
       - image: notnoopci/php:7.1.5-browsers

       ## DEFAULTS FOR THIS IMAGE ##
       - image: mysql
         environment:
           MYSQL_ROOT_PASSWORD: ''
           MYSQL_ALLOW_EMPTY_PASSWORD: yes
           MYSQL_DATABASE: drupal

     steps:
       - checkout
       - run: sudo apt-get install libpng-dev
       - run: sudo apt-get install mysql-client
       - run: sudo docker-php-ext-install pdo_mysql
       - run: sudo docker-php-ext-install gd
       - run: composer install
       - run: composer global require drush/drush:dev-master
       - run: cd web/ && ../vendor/bin/drush site-install --db-url=mysql://root:@127.0.0.1/drupal --yes
       - run: cd web/ && ./vendor/bin/drush config-import 
